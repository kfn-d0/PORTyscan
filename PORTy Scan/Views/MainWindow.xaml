<Window x:Class="PortScanner.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PORTy Scan - Advanced Port Scanner"
        Width="1150" Height="800"
        MinWidth="950" MinHeight="650"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BgPrimary}"
        FontFamily="Segoe UI Semibold">

    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,32">
            <TextBlock Text="ðŸŽ¯" FontSize="36" VerticalAlignment="Center" Margin="0,0,16,0"/>
            <StackPanel>
                <TextBlock Text="PORTy Scan" FontSize="32" FontWeight="ExtraBold" Foreground="{StaticResource AccentBlue}"/>
                <TextBlock Text="Network Reconnaissance Tool" FontSize="14" Foreground="{StaticResource TextSecondary}" Margin="2,0,0,0"/>
            </StackPanel>
        </StackPanel>

        <!-- Config Card -->
        <Border Grid.Row="1" Style="{StaticResource GlassCard}" Margin="0,0,0,24">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="220"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Column="0" Margin="0,0,24,20">
                    <TextBlock Text="TARGET ADDRESS" Style="{StaticResource StatLabel}" HorizontalAlignment="Left" Margin="0,0,0,8"/>
                    <TextBox Text="{Binding Target, UpdateSourceTrigger=PropertyChanged}" FontSize="16" FontWeight="SemiBold"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Margin="0,0,0,20">
                    <TextBlock Text="PROTOCOL" Style="{StaticResource StatLabel}" HorizontalAlignment="Left" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding Protocols}" SelectedIndex="{Binding SelectedProtocolIndex}" Height="40" Padding="10,0"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,24,0">
                    <TextBlock Text="PORT PRESET" Style="{StaticResource StatLabel}" HorizontalAlignment="Left" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding PortPresets}" SelectedIndex="{Binding SelectedPortPresetIndex}" Height="40" Padding="10,0"/>
                    <TextBox Text="{Binding CustomPorts, UpdateSourceTrigger=PropertyChanged}" 
                             IsEnabled="{Binding IsCustomPortPreset}" 
                             Margin="0,12,0,0" ToolTip="Format: 80,443,1000-2000"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="2">
                    <Grid Margin="0,0,0,8">
                        <TextBlock Text="THREADS" Style="{StaticResource StatLabel}" HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Threads}" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" HorizontalAlignment="Right"/>
                    </Grid>
                    <Slider Minimum="10" Maximum="500" Value="{Binding Threads}" TickFrequency="10" IsSnapToTickEnabled="True"/>
                    
                    <Grid Margin="0,16,0,8">
                        <TextBlock Text="TIMEOUT (MS)" Style="{StaticResource StatLabel}" HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Timeout}" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" HorizontalAlignment="Right"/>
                    </Grid>
                    <Slider Minimum="100" Maximum="5000" Value="{Binding Timeout}" TickFrequency="100" IsSnapToTickEnabled="True"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Controls Area -->
        <Grid Grid.Row="2" Margin="0,0,0,24">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <Button Content="START SCAN" Style="{StaticResource PrimaryBtn}" Command="{Binding StartScanCommand}" Width="150" Height="45" Margin="0,0,12,0"/>
                <Button Content="STOP" Style="{StaticResource DangerBtn}" Command="{Binding StopScanCommand}" Width="100" Height="45" Margin="0,0,24,0"/>
                
                <Border VerticalAlignment="Center" Background="#161b22" CornerRadius="20" Padding="16,8">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="â±" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding ScanDuration}" FontFamily="Consolas" FontSize="14" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="CLEAR" Style="{StaticResource SecondaryBtn}" Command="{Binding ClearResultsCommand}" 
                        Visibility="{Binding HasResults, Converter={StaticResource BoolToVis}}" Margin="0,0,12,0"/>
                <Button Content="CSV" Style="{StaticResource SecondaryBtn}" Command="{Binding ExportCsvCommand}" Margin="0,0,12,0"/>
                <Button Content="HTML" Style="{StaticResource SecondaryBtn}" Command="{Binding ExportHtmlCommand}"/>
            </StackPanel>
        </Grid>

        <!-- Stats Area -->
        <Grid Grid.Row="3" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource StatCard}" Margin="0,0,16,0">
                <StackPanel>
                    <TextBlock Text="OPEN" Style="{StaticResource StatLabel}"/>
                    <TextBlock Text="{Binding OpenCount}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource AccentGreen}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Style="{StaticResource StatCard}" Margin="0,0,16,0">
                <StackPanel>
                    <TextBlock Text="CLOSED" Style="{StaticResource StatLabel}"/>
                    <TextBlock Text="{Binding ClosedCount}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource AccentRed}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="2" Style="{StaticResource StatCard}" Margin="0,0,16,0">
                <StackPanel>
                    <TextBlock Text="FILTERED" Style="{StaticResource StatLabel}"/>
                    <TextBlock Text="{Binding FilteredCount}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource AccentYellow}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="3" Style="{StaticResource StatCard}" Margin="0,0,16,0">
                <StackPanel>
                    <TextBlock Text="TOTAL" Style="{StaticResource StatLabel}"/>
                    <TextBlock Text="{Binding TotalScanned}" FontSize="28" FontWeight="Bold" Foreground="{StaticResource AccentBlue}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <StackPanel Grid.Column="4" VerticalAlignment="Center" Margin="12,0,0,0">
                <Grid Margin="0,0,0,10">
                    <TextBlock Text="{Binding ProgressText}" Foreground="{StaticResource TextPrimary}" FontWeight="Bold"/>
                    <TextBlock Text="{Binding Progress, StringFormat={}{0:F0}%}" Foreground="{StaticResource AccentBlue}" HorizontalAlignment="Right" FontWeight="Bold"/>
                </Grid>
                <ProgressBar Value="{Binding Progress}"/>
            </StackPanel>
        </Grid>

        <!-- Results Table -->
        <Border Grid.Row="4" Style="{StaticResource GlassCard}" Padding="0" ClipToBounds="True">
            <DataGrid ItemsSource="{Binding Results}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      BorderThickness="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="TARGET HOST" Binding="{Binding Target}" Width="160"/>
                    <DataGridTextColumn Header="DNS HOSTNAME" Binding="{Binding Hostname}" Width="200">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="{StaticResource AccentBlue}"/>
                                <Setter Property="FontSize" Value="12"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="PORT" Binding="{Binding Port}" Width="80"/>
                    <DataGridTextColumn Header="PROTOCOL" Binding="{Binding Protocol}" Width="100"/>
                    <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="120">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Status}" Value="Open">
                                        <Setter Property="Foreground" Value="{StaticResource AccentGreen}"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="SERVICE IDENTIFIED" Binding="{Binding Service}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</Window>
